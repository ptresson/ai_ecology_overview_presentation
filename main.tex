%%% compiles with
%% latexmk  -auxdir=aux/ main.tex
%%% compress with
%% gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/prepress -dNOPAUSE -dQUIET -dBATCH -sOutputFile=compressed_PDF_file.pdf input_PDF_file.pdf
\documentclass{irdbeamer}
\usepackage{tikz}
\usepackage{marvosym}
\usepackage{amsfonts}

\title{Artificial Intelligence in Ecology and Evolution : \\ potential and limits}
\subtitle{E2M2 webinar}
\author[Paul Tresson]{Paul Tresson}
\date{26/06/25} % or whatever the date you are presenting in is
% \institute[Institut de Recherche pour le Développement]{UMR AMAP}

%\copyrightnotice{Published by Institut de Recherche pour le Développement, with permission}

% %% to add a background image for the title slide, uncomment here
% \usebackgroundtemplate{
%   \tikz[overlay, remember picture] \node[at=(current page.center)] {
%     \includegraphics[width=\paperwidth,height=\paperheight]{example-image-a}
%   };
% }

\usepackage[
    backend=biber,
    style=authoryear-comp,
    maxcitenames=2, % max 2 authors before switching to et al.
    maxbibnames=4,
    uniquelist=false, % stays et al. when almost the same authors
    uniquename=false, % dose not bother when first name not written the same way everywhere
    date=year, % month does not appear in bibliography
    natbib=true, % use natbib synthax
    url=false, % remove url
    eprint=false % remove eprint
]{biblatex}

\addbibresource{refs.bib}

\let\oldcite=\cite                                                              
\renewcommand{\cite}[1]{\textcolor[rgb]{.5,.5,.7}{\oldcite{#1}}}
\let\oldcitep=\citep                                                              
\renewcommand{\citep}[1]{\textcolor[rgb]{.5,.5,.7}{\oldcitep{#1}}}

\begin{document}

\addlogo{logos/IRD_banner.png}
\addlogo{logos/AMAP_banner.png}
\addlogo{logos/E2M2.jpeg}
\maketitle

\usebackgroundtemplate{}

\begin{frame}{Disclaimer}
    \vspace{-1cm}
    \centering
    AI is not only deep learning
    \begin{figure}
            \includegraphics[width=0.4\textwidth]{./figs/goodfellow_AI.png}
        \caption{\tiny \cite{goodfellow2016deep}}
    \end{figure}
\end{frame}

\cutoc{}

\section{Why use deep learning in ecology ?}


\begin{frame}{More and more data}
\begin{columns}
    \column{0.5\linewidth}
    \begin{figure}
        \centering
        \includegraphics<1>[width=\linewidth]{figs/sentinel}
        \includegraphics<2>[width=\linewidth]{figs/spectrogramm}
        \includegraphics<3>[width=\linewidth]{figs/plantnet.jpg}
    \end{figure}
    % \only<1>{\nonumbernote{ }}
    \only<2>{\nonumbernote{Mac Aodha \textit{et al.} 2022}}
    \only<3>{\nonumbernote{\url{plantnet.org}}}
    \column{0.5\linewidth}
\begin{itemize}
    \item<1-> UAVs, Satellite
    \item<2-> Camera trap, accoustic
    \item<3-> Citizen science
    \item[\large\MVRightarrow{}]<4-> \textbf{Better coverage, better monitoring}
\end{itemize}
    
\end{columns}
\end{frame}

\begin{frame}{Data analysis and interpretation is time consuming}
\begin{columns}
    \column{0.5\linewidth}
\begin{itemize}
    \item<1-> A computer does not sleep
    \item<1-> A computer does not get tired
    \item[\large\MVRightarrow{}]<2-> \textbf{Automation now possible}
\end{itemize}
    \column{0.5\linewidth}
        \only<2>{\vspace{-.8cm}}
    \begin{figure}
        \centering
        \includegraphics<1>[width=0.8\linewidth]{figs/grieshop_et_al.png}
        \includegraphics<2>[width=0.5\linewidth]{./figs/xkcd_photo_is_a_bird.png}
        \only<1>{\caption{\small \cite{grieshop2012big}}}
        \only<2>{\caption{xkcd 1425, 2014}}
    \end{figure}
\end{columns}
\end{frame}

\section{What are the cases where deep learning does work ? \\ \small{and other models don't}}

\begin{frame}{Model complex, non-linear and abstract relationships}
\begin{columns}
    \column{0.33\linewidth}
    \begin{figure}
        \centering
        \includegraphics[width=\linewidth]{figs/chatgpt_haiku.png}
    \end{figure}
    \column{0.33\linewidth}
    \begin{figure}
        \centering
        \includegraphics[width=\linewidth]{figs/uav_stable_diffusion.png}
    \end{figure}
    \column{0.33\linewidth}
    \begin{figure}
        \centering
        \includegraphics[width=\linewidth]{figs/alphago.jpg}
    \end{figure}
\end{columns}
\end{frame}

\begin{frame}{Interpolation and generalisation}
    \begin{figure}
        \centering
        \includegraphics[width=0.5\linewidth]{figs/plantclef2020.png}
        \caption{PlantClef 2020 Dataset}
    \end{figure}
\end{frame}

\section{What are the cases where deep learning doesn't work ?\\
\small{common traps when working with living things}}

\begin{frame}[t]{Contraints in ecology}
    \only<1->{Data from the real world is noisy,}%
    \only<2->{ unbalanced,}%
    \only<3->{ hard to collect,}%
    \only<4->{ hard to interpret.}%

            \centering
    \includegraphics<1>[width=.8\textwidth]{./figs/bouamir.png}%
    \includegraphics<2>[width=.7\textwidth]{./figs/plantnet_longtail.png}%
    % \only<2>{\tiny \\Distribution of species represented in plantnet dataset}
    \includegraphics<3>[width=.3\textwidth]{./figs/climbing.png}%
    \includegraphics<4>[width=.3\textwidth]{./figs/recapcha.png}%
    \includegraphics<5>[width=.3\textwidth]{./figs/recapcha_plantnet.png}%
    \includegraphics<6>[width=.3\textwidth]{./figs/recapcha_pheidole.png}%
\end{frame}

\begin{frame}
    \centering
    \large \textbf{Overfitting}
\end{frame}

\begin{frame}{Overfitting}
    \begin{figure}
        \begin{center}
            \includegraphics[width=\textwidth]{./figs/overfitting-overview.png}
            % \caption{\tiny \cite{goodfellow2016deep}}
        \end{center}
    \end{figure}
\end{frame}

\begin{frame}{Overfitting}
    \begin{figure}
        \begin{center}
            \includegraphics[width=0.7\textwidth]{./figs/goodfellow.png}
            \caption{\tiny \cite{goodfellow2016deep}}
        \end{center}
    \end{figure}
\end{frame}

\begin{frame}{}
    \centering
    \includegraphics<1>[width=.5\textwidth]{./figs/schemas/train.png}%
    \includegraphics<2>[width=.5\textwidth]{./figs/schemas/good_fit.png}%
    \includegraphics<3>[width=.5\textwidth]{./figs/schemas/good_fit_test.png}%
    \includegraphics<4>[width=.5\textwidth]{./figs/schemas/bad_fit.png}%

    \only<1>{Train set}%
    \only<2>{\small A good fitted model}%
    \only<3>{Test set}%
    \only<4>{\footnotesize Overfitting}%
\end{frame}

\begin{frame}
    \centering
    \large \textbf{Biases}
\end{frame}

\begin{frame}{Biases in the train set}
    \begin{columns}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1-2>[width=.9\textwidth]{./figs/monstera-plantnet.png}%
    \includegraphics<3>[width=.5\textwidth]{./figs/monstera-wild.jpg}%
        \end{column}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1>[width=.8\textwidth]{./figs/schemas/train.png}%
    \includegraphics<2>[width=.8\textwidth]{./figs/schemas/good_fit.png}%
    \includegraphics<3>[width=.8\textwidth]{./figs/schemas/bad_test.png}%
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Biases in the train set - autocorrelation}
    \begin{columns}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1>[width=.8\textwidth]{./figs/camera_trap_frames.png}%
    \includegraphics<2>[width=.8\textwidth]{./figs/camera_trap_frames1.png}%
    \includegraphics<3>[width=.8\textwidth]{./figs/camera_trap_frames2.png}%
    \includegraphics<4>[width=.8\textwidth]{./figs/camera_trap_craw.JPG}%
    \includegraphics<5>[width=.8\textwidth]{./figs/camera_trap_cubs.png}%
        \end{column}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<2>[width=.8\textwidth]{./figs/schemas/train.png}%
    \includegraphics<3>[width=.8\textwidth]{./figs/schemas/autocorr_test.png}%
    \includegraphics<4->[width=.8\textwidth]{./figs/schemas/autocorr.png}%
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Biases in the train set - Spatial autocorrelation}
    \begin{columns}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1-3>[width=.5\textwidth]{./figs/spatial/2022.png}%
    \includegraphics<4>[width=.5\textwidth]{./figs/spatial/2022_pleiades.png}%
        \end{column}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<2>[width=.5\textwidth]{./figs/spatial/vit_dino_4cl.png}%
    \includegraphics<3->[width=.5\textwidth]{./figs/spatial/resnet_dino.png}%
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \centering
    \large \textbf{Unbalanced data}
\end{frame}

\begin{frame}{Unbalanced data}
            \centering
    \includegraphics<1>[width=.4\textwidth]{./figs/schemas/unbalanced.png}%
    \includegraphics<2>[width=.4\textwidth]{./figs/schemas/unb_tight.png}%
    \includegraphics<3>[width=.4\textwidth]{./figs/schemas/unb_tight_test_unb.png}%
    \includegraphics<4>[width=.4\textwidth]{./figs/schemas/test_unb_bad.png}%
\end{frame}

\begin{frame}{Deal with unbalanced data}
    \begin{columns}
        \begin{column}{.5\linewidth}
            \begin{itemize}
                \item<1-> Oversample ?
                \item<4-> Undersample/saturate ?
                \item<7-> Adapt loss ?
            \end{itemize}
        \end{column}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1>[width=.8\textwidth]{./figs/schemas/oversampled.png}%
    \includegraphics<2>[width=.8\textwidth]{./figs/schemas/oversampled_fit.png}%
    \includegraphics<3>[width=.8\textwidth]{./figs/schemas/fp.png}%
    \includegraphics<4>[width=.8\textwidth]{./figs/schemas/undersample.png}%
    \includegraphics<5>[width=.8\textwidth]{./figs/schemas/undersample_fit.png}%
    \includegraphics<6>[width=.8\textwidth]{./figs/schemas/fn.png}%
    \includegraphics<7>[width=.8\textwidth]{./figs/schemas/adapt_loss.png}%
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Deal with lack of data}
    \begin{columns}
        \begin{column}{.5\linewidth}
            \begin{itemize}
                \item<1-> Data augmentation
                \item<3-> Pretrained model
                \item<4> \textbf{... collect more data}
            \end{itemize}
        \end{column}
        \begin{column}{.5\linewidth}
            \centering
    \includegraphics<1>[width=.8\textwidth]{./figs/schemas/train.png}%
    \includegraphics<2>[width=.8\textwidth]{./figs/schemas/data_aug.png}%
    \includegraphics<3>[width=.8\textwidth]{./figs/schemas/pretrained.png}%
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \centering
    \large \textbf{Out of distribution}
\end{frame}

\begin{frame}{Out of distribution : Evolution with time}
\begin{columns}
    \column{.5\linewidth}
\begin{figure}
    \centering
    \includegraphics<1->[width=\linewidth]{figs/vela_et_al_frise.png}
\end{figure}
    \column{.5\linewidth}
\begin{figure}
    \centering
    \includegraphics<2>[width=\linewidth]{figs/vela_et_al_graph.png}
\end{figure}
\end{columns}
    \nonumbernote{\tiny{Adapted from \cite{vela2022temporal}}}
\end{frame}

\begin{frame}{Out of distribution : Global changes}

Conditions will evolve in never seen before conditions:
\begin{itemize}
    \item<1-> Given ecosystem in unprecedented climatic conditions
    \item<2-> Species migrate/invade in new territories
\end{itemize}

\end{frame}

\begin{frame}{Out of distribution : Invasive species}

New unknown species in the training test appears in a region.

\begin{itemize}
    \item<1-> False Positive : confusion with known species
    \item<2-> False Negative : model misses the new species
    \item<3-> Handmade check on model confidence
\end{itemize}
    
\end{frame}

\begin{frame}{}
    \centering
    \textbf{Need to be very careful on how to evaluate}
\end{frame}

\section{How to sample and evaluate ?}

\begin{frame}{Random split ?}
    \begin{center}
    \textcolor{black}{"random split training validation 80/20"}
    \end{center}
    \pause
        \centering
        \vspace{-0.5cm}
            \fbox{\includegraphics[width=.7\paperwidth,]{./figs/random_sampling.png}}

            \cite{oquab2023dinov2}
    \pause

    Works for huge DL papers, maybe not for you
\end{frame}

\begin{frame}{Overfitting the test set}
    \centering
    \includegraphics<1>[width=.5\textwidth]{./figs/schemas/lucky_test.png}%
    \includegraphics<2>[width=.5\textwidth]{./figs/schemas/overfit_test1.png}%
    \includegraphics<3>[width=.5\textwidth]{./figs/schemas/overfit_test2.png}%
    \includegraphics<4>[width=.5\textwidth]{./figs/schemas/overfit_test3.png}%
    \includegraphics<5>[width=.5\textwidth]{./figs/schemas/overfit_test4.png}%
    \includegraphics<6>[width=.5\textwidth]{./figs/schemas/overfit_test5.png}%
\end{frame}

\begin{frame}{Cross-validation}
    \centering
    \includegraphics[width=.5\textwidth]{./figs/cross_validation.png}
    \nonumbernote{\tiny Figure from scikit-learn docs}
\end{frame}

\begin{frame}{Cross-validation}
    \centering
    \includegraphics<1>[width=.7\textwidth]{./figs/kfold.png}%
    \includegraphics<2>[width=.7\textwidth]{./figs/stratified_kfold.png}%
    \nonumbernote{\tiny Figure from scikit-learn docs}
\end{frame}

\begin{frame}{Spatial cross-validation}
    \centering
    \includegraphics<1>[width=.5\textwidth]{./figs/spatial/ploton2020.png}%
    \includegraphics<2>[width=.5\textwidth]{./figs/spatial/ploton2020-result.png}%
    
    \tiny See. \cite{ploton2020spatial}
\end{frame}

\begin{frame}{Choosing the right metric}
\begin{columns}
    \column{.5\linewidth}
    \centering
    \includegraphics[width=.8\textwidth]{./figs/schemas/AP_vs_Accuracy.png}%
    \column{.5\linewidth}
    \only<2>{\textbf{If we predict Sp.~1 all the time:}
            \begin{tabular}{lcc}
                Accuracy & = & 0.75 \\
                Average precision & = & 0.05 \\
            \end{tabular}
            }
\end{columns}
\end{frame}

\section{Perspectives}

\begin{frame}{Models are more robust and generalist}
\begin{columns}
    \column{0.5\linewidth}
    \begin{figure}
        \centering
        \includegraphics<1>[width=\linewidth]{figs/dinov2_pca.png}
        \includegraphics<2>[width=\linewidth]{figs/dinov2.png}
    \end{figure}
    \column{0.5\linewidth}
\begin{itemize}
    \item<1-> Self-supervised Learning (Pre-training)
    \item<2-> Better performances and robustness
\end{itemize}
    
\end{columns}
    \nonumbernote{\small \cite{oquab2023dinov2}}
    
\end{frame}

\begin{frame}{Zero-shot at a cost}
\begin{figure}
    \centering
    \includegraphics[width=.8\linewidth]{figs/no_zero_shot.png}
\end{figure}
    \nonumbernote{\small \cite{udandarao2024no}}
\end{frame}


\begin{frame}{Not only deep learning}
    
\begin{columns}[t]
    \column{.5\linewidth}
    \centering
    \includegraphics[width=.8\textwidth]{./figs/justeau1.png}%
    \column{.5\linewidth}
    \centering
    \includegraphics[width=.8\textwidth]{./figs/justeau2.png}%
\end{columns}
    \nonumbernote{\cite{justeau2024refining}}

\end{frame}

\begin{frame}{Conclusion}

Should I use deep learning in my research ?
\begin{columns}[t]
    \column{.5\linewidth}
    \begin{itemize}
        \item[\checkmark] Lot of incoming data
        \item[\checkmark] Low-level data
        \item[\checkmark] Cumbersome but (relatively) easy to analyse
    \end{itemize}
    \column{.5\linewidth}
    \begin{itemize}
        \item[$\times$] Need for explainability
        \item[$\times$] \textbf{Need for certainty}
        \item[$\times$] \textbf{Need for reliability}
    \end{itemize}
\end{columns}

\end{frame}

\begin{frame}[plain]
    \Huge{Thank you for your attention !}
    
    \vfill
    
    \LARGE{Any questions?}
\end{frame}


\appendix

\begin{frame}{Useful ressources}
\begin{columns}[t]
    \column{.5\linewidth}
    \textbf{State of the art}
    \begin{itemize}
        \item \href{https://huggingface.co/}{Huggingface}
        \item \href{https://paperswithcode.com/sota}{PapersWithCode}
    \end{itemize}
    \textbf{Getting started}
    \begin{itemize}
        \item \href{https://docs.pytorch.org/tutorials/}{Pytorch}
        \item \href{https://keras.io/getting_started/}{Keras}
    \end{itemize}
    \column{.5\linewidth}
    \textbf{Understanding papers}
    \begin{itemize}
        \item \href{https://www.youtube.com/@YannicKilcher}{Yannic Kilcher}
        \item \href{https://www.youtube.com/@AICoffeeBreak}{AI coffe break}
    \end{itemize}
    \textbf{Understanding visually}
    \begin{itemize}
        \item \href{https://www.youtube.com/@3blue1brown}{3blue1brown}
        \item \href{https://www.youtube.com/@Deepia-ls2fo}{deepia}
    \end{itemize}
\end{columns}

\end{frame}

\begin{frame}[allowframebreaks]{References}
\setbeamertemplate{bibliography item}{}
    {\footnotesize \printbibliography[heading=none]}
\end{frame}

% \begin{frame}{Backup slides go here}
    
% \end{frame}

\end{document}
